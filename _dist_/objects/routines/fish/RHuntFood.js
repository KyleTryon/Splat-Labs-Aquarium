import a from"../Routine.js";export default class r extends a{constructor(e){super({name:"hunt",priority:.1,fish:e.fish})}calcPriority(){this._availableFood=this.fish.scene.fishFood,this._availableFood.getLength()>0?this.priority=.99:this.priority=0}execute(){if(this._availableFood=this.fish.scene.fishFood,this._availableFood.getLength()>0){let e=this._availableFood.getChildren().sort((t,i)=>{let h=Phaser.Math.Distance.Between(this.fish.x,this.fish.y,t.x,t.y),o=Phaser.Math.Distance.Between(this.fish.x,this.fish.y,i.x,i.y);return h>o?1:h==o?0:-1}),s=Phaser.Math.Distance.Between(this.fish.x,this.fish.y,e[0].x,e[0].y);if(s<this.fish.width/2)this.eatFood(e[0]);else if(s<this.fish.perceptionDistance){let t=e[0]._body.velocity,i=new Phaser.Math.Vector2(e[0].x+t.x*this.fish._deltaTime,e[0].y+t.y*this.fish._deltaTime);this.fish.target=i,this.fish.swimToTarget(20,2)}}}eatFood(e){this._availableFood.remove(e,!0),this.fish.energy+=e.foodValue}}
